---
title: "Change in Patient Count Over Time with Respect to Different Regions and SIMD"
subtitle: ""
author: "the RegRession Rebels <br> Kenny Chen, Matthew Brown, Jake Leung, Aleksandra Iwaszkiewicz, Sarah De Giuli"
institute: "University of Edinburgh"
date: "`r Sys.Date()`"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      
---

```{r install-package, include = FALSE, eval = FALSE}
# Copy and paste the following code into your console to download and install
# the `xaringan` package that contains all of the code which allows you 
# to create presentation slides in Rmarkdown
install.packages('xaringan')
```


```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(tidymodels)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
library(readxl)
```

```{r setup, include=FALSE}
# For better figure resolution
knitr::opts_chunk$set(fig.retina = 3, dpi = 300, fig.width = 6, fig.asp = 0.618, out.width = "80%")
```

```{r load-data, include=FALSE}
diagnosis <- read_csv("data/mental-health-inpatient-activity-diagnosis-trend.csv", show_col_types = FALSE)

deprivation <- read_csv("data/mental-health-inpatient-activity-deprivation.csv", show_col_types = FALSE)

age_and_sex <- read_csv("data/mental-health-inpatient-activity-age-sex.csv", show_col_types = FALSE)

icd_10_codes <- read_xlsx("data/icd10-lookup.xlsx")

diagnosis_BUT_READABLE <- diagnosis %>% 
  mutate(icd_categories = case_when(
    ICD10Codes == "F00 - F09 or Chapter G and second position F00" ~ "Organic, including symptomatic, mental disorders", 
    ICD10Codes == "F10 - F19" ~ "Mental & behavioural disorders due to psychoactive substance use", 
    ICD10Codes == "F20 - F29" ~ "Schizophrenia, schizotypal, & delusional disorders", 
    ICD10Codes == "F30 - F39" ~ "Mood (affective) disorders", 
    ICD10Codes == "F40 - F49" ~ "Neurotic, stress-related, & somatoform disorders", 
    ICD10Codes == "F60 - F69" ~ "Disorders of adult personality & behaviour", 
    ICD10Codes == "F50 - F59, F70 - F99" ~ "Other selected diagnoses principally affecting children & young people", 
    ICD10Codes == "Non-F codes" ~ "Unrecognized diagnosis", 
                       .default = ICD10Codes )) %>% 
  select(!ICD10Codes)

diagnosis_BUT_READABLE <- diagnosis_BUT_READABLE %>% 
  mutate(smr_translated = case_when(
    Dataset == "SMR00" ~ "Outpatients",
    Dataset == "SMR01" ~ "General/Acute Inpatients/Day Cases (including Geriatric Long Stay Inpatients)",
    Dataset == "SMR02" ~ "Maternity Inpatients/Day Cases",
    Dataset == "SMR04" ~ "Mental Health Inpatients/Day Cases",
              .default = Dataset )) %>% 
  select(!Dataset)

diagnosis_BUT_READABLE <- diagnosis_BUT_READABLE %>% 
  select(
    FinancialYear, HBT, DischargeCount, DischargeRates, PatientsCount,
    PatientsRates,HospitalResidentsCount, HospitalResidentsRates,
    icd_categories, smr_translated) %>%
  mutate(DischargeRates = DischargeRates / 100000, PatientsRates = PatientsRates / 100000)

diagnosis_BUT_READABLE <- diagnosis_BUT_READABLE %>% 
  mutate(hbt_translated = case_when(
    HBT == "S92000003" ~ "Scotland",
    HBT == "S08000015" ~ "Ayrshire and Arran",
    HBT == "S08000016" ~ "Borders",
    HBT == "S08000017" ~ "Dumfries and Galloway",
    HBT == "S08000018" ~ "Fife",
    HBT == "S08000019" ~ "Forth Valley",
    HBT == "S08000020" ~ "Grampian",
    HBT == "S08000021" ~ "Greater Glasgow and Clyde",
    HBT == "S08000022" ~ "Highland",
    HBT == "S08000023" ~ "Lanarkshire",
    HBT == "S08000024" ~ "Lothian",
    HBT == "S08000025" ~ "Orkney",
    HBT == "S08000026" ~ "Shetland",
    HBT == "S08000027" ~ "Tayside",
    HBT == "S08000028" ~ "Western Isles",
    HBT == "S08000029" ~ "Fife",
    HBT == "S08000030" ~ "Tayside",
    HBT == "S08000031" ~ "Greater Glasgow and Clyde",
    HBT == "S08000032" ~ "Lanarkshire",
              .default = HBT)) %>% 
  select(!HBT)

deprivation_BUT_READABLE <- deprivation %>% 
  mutate(smr_translated = case_when(
    Dataset == "SMR00" ~ "Outpatients",
    Dataset == "SMR01" ~ "General/Acute Inpatients/Day Cases (including Geriatric Long Stay Inpatients)",
    Dataset == "SMR02" ~ "Maternity Inpatients/Day Cases",
    Dataset == "SMR03" ~ "Scottish Index of Deprivation",
    Dataset == "SMR04" ~ "Mental Health Inpatients/Day Cases",
              .default = Dataset )) %>% 
  select(!Dataset)

deprivation_BUT_READABLE <- deprivation_BUT_READABLE %>% 
  mutate(hbr_translated = case_when(
    HBR == "S92000003" ~ "Scotland",
    HBR == "S08000015" ~ "Ayrshire and Arran",
    HBR == "S08000016" ~ "Borders",
    HBR == "S08000017" ~ "Dumfries and Galloway",
    HBR == "S08000018" ~ "Fife",
    HBR == "S08000019" ~ "Forth Valley",
    HBR == "S08000020" ~ "Grampian",
    HBR == "S08000021" ~ "Greater Glasgow and Clyde",
    HBR == "S08000022" ~ "Highland",
    HBR == "S08000023" ~ "Lanarkshire",
    HBR == "S08000024" ~ "Lothian",
    HBR == "S08000025" ~ "Orkney",
    HBR == "S08000026" ~ "Shetland",
    HBR == "S08000027" ~ "Tayside",
    HBR == "S08000028" ~ "Western Isles",
    HBR == "S08000029" ~ "Fife",
    HBR == "S08000030" ~ "Tayside",
    HBR == "S08000031" ~ "Greater Glasgow and Clyde",
    HBR == "S08000032" ~ "Lanarkshire",
              .default = HBR )) %>% 
  select(!HBR)

deprivation_BUT_READABLE <- deprivation_BUT_READABLE %>% 
  select(
    FinancialYear, hbr_translated, SIMD, smr_translated, DischargeCount, DischargeRates,
    PatientsCount, PatientsRates,HospitalResidentsCount, HospitalResidentsRates) %>%
  mutate(DischargeRates = DischargeRates / 100000, PatientsRates = PatientsRates / 100000)


age_and_sex_BUT_READABLE <- age_and_sex %>% mutate(hbr_translated = case_when(
HBR == "S92000003" ~ "Scotland",
HBR == "S08000015" ~ "Ayrshire and Arran",
HBR == "S08000016" ~ "Borders",
HBR == "S08000017" ~ "Dumfries and Galloway",
HBR == "S08000018" ~ "Fife",
HBR == "S08000019" ~ "Forth Valley",
HBR == "S08000020" ~ "Grampian",
HBR == "S08000021" ~ "Greater Glasgow and Clyde",
HBR == "S08000022" ~ "Highland",
HBR == "S08000023" ~ "Lanarkshire",
HBR == "S08000024" ~ "Lothian",
HBR == "S08000025" ~ "Orkney",
HBR == "S08000026" ~ "Shetland",
HBR == "S08000027" ~ "Tayside",
HBR == "S08000028" ~ "Western Isles",
HBR == "S08000029" ~ "Fife",
HBR == "S08000030" ~ "Tayside",
HBR == "S08000031" ~ "Greater Glasgow and Clyde",
HBR == "S08000032" ~ "Lanarkshire",
.default = HBR
)) %>% select(!HBR)

age_and_sex_BUT_READABLE <- age_and_sex_BUT_READABLE %>% 
  select(
    FinancialYear, AgeGroup, Sex, hbr_translated, DischargeCount, DischargeRates, PatientsCount,
    PatientsRates)
```

```{r include=FALSE}

#Background image 
style_xaringan(
  title_slide_background_image = "img/confetti.jpg"
)
```

class: center, middle

## To see if there is a correlation between how patient/discharge count has changed over time and your SIMD score


---

class: inverse, center, middle

# Cleaning Datasets

---

# Cleaning Datasets 
```{r cleaning code}
diagnosis_BUT_READABLE <- diagnosis %>% 
  mutate(icd_categories = case_when(
    ICD10Codes == "F00 - F09 or Chapter G and second position F00" ~ "Organic, including symptomatic, mental disorders", 
    ICD10Codes == "F10 - F19" ~ "Mental & behavioural disorders due to psychoactive substance use", 
    ICD10Codes == "F20 - F29" ~ "Schizophrenia, schizotypal, & delusional disorders", 
    ICD10Codes == "F30 - F39" ~ "Mood (affective) disorders", 
    ICD10Codes == "F40 - F49" ~ "Neurotic, stress-related, & somatoform disorders", 
    ICD10Codes == "F60 - F69" ~ "Disorders of adult personality & behaviour", 
    ICD10Codes == "F50 - F59, F70 - F99" ~ "Other selected diagnoses principally affecting children & young people", 
    ICD10Codes == "Non-F codes" ~ "Unrecognized diagnosis", 
                       .default = ICD10Codes )) %>% 
  select(!ICD10Codes)
```
- We chose to translate our data sets since technical codes are used thoroughly throughout the data set this made it easier for us and others to read it. This is an example above.

---
```{r more data}
diagnosis_BUT_READABLE <- diagnosis_BUT_READABLE %>% 
  mutate(hbt_translated = case_when(
    HBT == "S92000003" ~ "Scotland",
    HBT == "S08000015" ~ "Ayrshire and Arran",
    HBT == "S08000016" ~ "Borders",
    HBT == "S08000017" ~ "Dumfries and Galloway",
    HBT == "S08000018" ~ "Fife",
    HBT == "S08000019" ~ "Forth Valley",
    HBT == "S08000020" ~ "Grampian",
    HBT == "S08000021" ~ "Greater Glasgow and Clyde",
    HBT == "S08000022" ~ "Highland",
    HBT == "S08000023" ~ "Lanarkshire",
    HBT == "S08000024" ~ "Lothian",
    HBT == "S08000025" ~ "Orkney",
    HBT == "S08000026" ~ "Shetland",
    HBT == "S08000027" ~ "Tayside",
    HBT == "S08000028" ~ "Western Isles",
    HBT == "S08000029" ~ "Fife",
    HBT == "S08000030" ~ "Tayside",
    HBT == "S08000031" ~ "Greater Glasgow and Clyde",
    HBT == "S08000032" ~ "Lanarkshire",
              .default = HBT)) %>% 
  select(!HBT)
```

- Another example here
---
``` {r include = FALSE} 
deprivation_BUT_READABLE <- deprivation %>% 
  mutate(smr_translated = case_when(
    Dataset == "SMR00" ~ "Outpatients",
    Dataset == "SMR01" ~ "General/Acute Inpatients/Day Cases (including Geriatric Long Stay Inpatients)",
    Dataset == "SMR02" ~ "Maternity Inpatients/Day Cases",
    Dataset == "SMR03" ~ "Scottish Index of Deprivation",
    Dataset == "SMR04" ~ "Mental Health Inpatients/Day Cases",
              .default = Dataset )) %>% 
  select(!Dataset)

deprivation_BUT_READABLE <- deprivation_BUT_READABLE %>% 
  mutate(hbr_translated = case_when(
    HBR == "S92000003" ~ "Scotland",
    HBR == "S08000015" ~ "Ayrshire and Arran",
    HBR == "S08000016" ~ "Borders",
    HBR == "S08000017" ~ "Dumfries and Galloway",
    HBR == "S08000018" ~ "Fife",
    HBR == "S08000019" ~ "Forth Valley",
    HBR == "S08000020" ~ "Grampian",
    HBR == "S08000021" ~ "Greater Glasgow and Clyde",
    HBR == "S08000022" ~ "Highland",
    HBR == "S08000023" ~ "Lanarkshire",
    HBR == "S08000024" ~ "Lothian",
    HBR == "S08000025" ~ "Orkney",
    HBR == "S08000026" ~ "Shetland",
    HBR == "S08000027" ~ "Tayside",
    HBR == "S08000028" ~ "Western Isles",
    HBR == "S08000029" ~ "Fife",
    HBR == "S08000030" ~ "Tayside",
    HBR == "S08000031" ~ "Greater Glasgow and Clyde",
    HBR == "S08000032" ~ "Lanarkshire",
              .default = HBR )) %>% 
  select(!HBR)

deprivation_BUT_READABLE <- deprivation_BUT_READABLE %>% 
  select(
    FinancialYear, hbr_translated, SIMD, smr_translated, DischargeCount, DischargeRates,
    PatientsCount, PatientsRates,HospitalResidentsCount, HospitalResidentsRates) %>%
  mutate(DischargeRates = DischargeRates / 100000, PatientsRates = PatientsRates / 100000)


age_and_sex_BUT_READABLE <- age_and_sex %>% mutate(hbr_translated = case_when(
HBR == "S92000003" ~ "Scotland",
HBR == "S08000015" ~ "Ayrshire and Arran",
HBR == "S08000016" ~ "Borders",
HBR == "S08000017" ~ "Dumfries and Galloway",
HBR == "S08000018" ~ "Fife",
HBR == "S08000019" ~ "Forth Valley",
HBR == "S08000020" ~ "Grampian",
HBR == "S08000021" ~ "Greater Glasgow and Clyde",
HBR == "S08000022" ~ "Highland",
HBR == "S08000023" ~ "Lanarkshire",
HBR == "S08000024" ~ "Lothian",
HBR == "S08000025" ~ "Orkney",
HBR == "S08000026" ~ "Shetland",
HBR == "S08000027" ~ "Tayside",
HBR == "S08000028" ~ "Western Isles",
HBR == "S08000029" ~ "Fife",
HBR == "S08000030" ~ "Tayside",
HBR == "S08000031" ~ "Greater Glasgow and Clyde",
HBR == "S08000032" ~ "Lanarkshire",
.default = HBR
)) %>% select(!HBR)

age_and_sex_BUT_READABLE <- age_and_sex_BUT_READABLE %>% 
  select(
    FinancialYear, AgeGroup, Sex, hbr_translated, DischargeCount, DischargeRates, PatientsCount,
    PatientsRates)
```
class: inverse, middle, center

# Initial Visuals

---

```{r visual1, echo=FALSE}
diagnosis_BUT_READABLE %>%
  group_by( FinancialYear) %>%
  summarise(Sum_PatientsCount = sum(PatientsCount, na.rm = TRUE), .groups = "keep") %>%
  
  ggplot(mapping = aes(x = FinancialYear, y = Sum_PatientsCount)) +
  geom_point() +
  labs(title = "Scatter Plot of Total Patients Count by Category",
       x = "Financial Year",
       y = "Sum of Patients Count") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 6))
```
We decided to see if we could find trends in the patient count data to see if correlations could be found between this and SIMD. Here it looks to have a general falling of patients from 1997/98 but starts rising again after 2013/14 and dropping suddenly at 2020/21 due to COVID
---
```{r visual2, echo=FALSE}
diagnosis_BUT_READABLE %>%
  group_by(FinancialYear) %>%
  summarise(Sum_DischargeCount = sum(DischargeCount, na.rm = TRUE), .groups = "keep") %>%
  
  ggplot(mapping = aes(x = FinancialYear, y = Sum_DischargeCount)) +
  geom_point() +
  labs(title = "Scatter Plot of Total Discharge Count by Category",
       x = "Financial Year",
       y = "Sum of Discharge numbers") +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 6))
```
A similar pattern can be found here with the discharge counts
---
```{r visual3, echo=FALSE}
deprivation_BUT_READABLE %>%
  group_by(SIMD) %>%
  summarise(TotalPatientsCount = sum(PatientsCount)) %>%
ggplot(aes(x = as.factor(SIMD), y = TotalPatientsCount)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Patients Count vs SIMD",
       x = "SIMD",
       y = "Patients Count") +
  theme_minimal() 
```

Mostly a downward trend here with the SIMD attempting to visualize how SIMD may affect patient counts to see if there is a clear correlation. Seemingly no effect.
---
```{r visual4, echo=FALSE}
deprivation_by_simd <- deprivation_BUT_READABLE %>%
                      group_by(SIMD) %>%
                      summarise(TotalPatientsRates = sum(PatientsRates) / (n()))
deprivation_by_simd %>%
  ggplot(mapping = aes(x = SIMD, y = TotalPatientsRates)) +
    geom_point() +
    geom_smooth(method = "lm", se = FALSE, color = "cyan") +  
    labs(title = "Scatterplot with Linear Regression Line: SIMD vs Patients Rates",
         x = "SIMD",
         y = "Patients Rate") +
    theme_minimal()
```

This visualization shows something similar.
---
class: inverse, middle, center
#Linear Models
---
#Linear Model 1
``` {r linear model1.1}
deprivation_lin_model <- linear_reg() %>% 
  set_engine("lm") %>% 
  fit(PatientsRates ~ SIMD, data = deprivation_BUT_READABLE)
tidy(deprivation_lin_model)
```
---
```{r linear model1.2, echo=FALSE}
deprivation_simd_lin_model_aug <- augment(deprivation_lin_model$fit)

ggplot(deprivation_simd_lin_model_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.3) +
  geom_hline(yintercept = 0, color = "gray", lty = "dashed") +
  labs(x = "Predicted Total Patients Rates", y = "Residuals")
```
---
#Quick fix
```{r fixing financial year}
diagnosis_pre_2011 <- diagnosis_BUT_READABLE %>%
  mutate(FinancialYear = strtoi (substring(FinancialYear, 1,4))) %>%
  filter(FinancialYear < 2011, FinancialYear < 2020)
  
  diagnosis_post_2011 <- diagnosis_BUT_READABLE %>%
  mutate(FinancialYear = strtoi (substring(FinancialYear, 1,4))) %>%
  filter(FinancialYear >= 2011 , FinancialYear < 2020)
```

---
#Linear Model 2
```{r linear model 2.1}
diagnosis_pre_2011_lin_model <- linear_reg() %>% 
  set_engine("lm") %>% 
  fit(PatientsCount ~ FinancialYear, data = diagnosis_pre_2011)

diagnosis_pre_2011_lin_model

```
---
```{r linear model 2.2}
diagnosis_post_2011_lin_model <- linear_reg() %>% 
  set_engine("lm") %>% 
  fit(PatientsCount ~ FinancialYear, data = diagnosis_post_2011)

diagnosis_post_2011_lin_model
```
---
```{r linear model 2.3 , echo=FALSE}
diagnosis_pre_2011_lin_model_aug <- augment(diagnosis_pre_2011_lin_model$fit)

ggplot(diagnosis_pre_2011_lin_model_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.3) +
  geom_hline(yintercept = 0, color = "gray", lty = "dashed") +
  labs(title = "Residuals of Predicted Total Pateints Rates pre 2011 exclusive", x = "Predicted Total Patients Rates", y = "Residuals")
glance(diagnosis_pre_2011_lin_model)$r.squared
```
---
```{r linear model 2.4, echo=FALSE}
diagnosis_post_2011_lin_model_aug <- augment(diagnosis_post_2011_lin_model$fit)

ggplot(diagnosis_pre_2011_lin_model_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.3) +
  geom_hline(yintercept = 0, color = "gray", lty = "dashed") +
  labs(title = "Residuals of Predicted Total Pateints Rates post 2011 inclusive", x = "Predicted Total Patients Rates", y = "Residuals")
glance(diagnosis_post_2011_lin_model)$r.squared

```
---
#Change to Cumulative Data
```{r cum}
diagnosis_pre_2011_cum <- diagnosis_pre_2011 %>% group_by(FinancialYear) %>% summarise(TotalPatientsCount = sum(PatientsCount, na.rm = TRUE))

diagnosis_post_2011_cum <- diagnosis_post_2011 %>% group_by(FinancialYear) %>% summarise(TotalPatientsCount = sum(PatientsCount, na.rm = TRUE))
```
---
```{r linear model 3.1}
diagnosis_pre_2011_cum_lin_model <- linear_reg() %>% 
  set_engine("lm") %>% 
  fit(TotalPatientsCount ~ FinancialYear, data = diagnosis_pre_2011_cum)

diagnosis_pre_2011_cum_lin_model
```
---
```{r linear model 3.2}
diagnosis_post_2011_cum_lin_model <- linear_reg() %>% 
  set_engine("lm") %>% 
  fit(TotalPatientsCount ~ FinancialYear, data = diagnosis_post_2011_cum)

diagnosis_post_2011_cum_lin_model
```
---
```{r linear model 3.3, echo=FALSE}
diagnosis_pre_2011_cum_lin_model_aug <- augment(diagnosis_post_2011_cum_lin_model$fit)

ggplot(diagnosis_pre_2011_lin_model_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.3) +
  geom_hline(yintercept = 0, color = "gray", lty = "dashed") +
  labs(title = "Residuals of Predicted Total Pateints Rates pre 2011 exclusive", x = "Predicted Total Patients Rates", y = "Residuals")
glance(diagnosis_pre_2011_cum_lin_model)$r.squared
```
---
```{r linear model 3.4, echo=FALSE}
diagnosis_post_2011_cum_lin_model_aug <- augment(diagnosis_post_2011_cum_lin_model$fit)

ggplot(diagnosis_pre_2011_lin_model_aug, mapping = aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.3) +
  geom_hline(yintercept = 0, color = "gray", lty = "dashed") +
  labs(title = "Residuals of Predicted Total Pateints Rates post 2011 inclusive", x = "Predicted Total Patients Rates", y = "Residuals")
glance(diagnosis_post_2011_cum_lin_model)$r.squared
```
---
class: inverse, middle, center
#Workflow
---
``` {r workflow-code}
set.seed(1116)
diagnosis_pre_2011 <- na.omit(diagnosis_pre_2011)
diagnosis_pre_2011_split <- initial_split(diagnosis_pre_2011, prop = 0.80)

pre_train_data <- training(diagnosis_pre_2011_split)
pre_test_data <- testing(diagnosis_pre_2011_split)


pre_rec <- recipe(PatientsCount ~ FinancialYear, data = pre_train_data) %>%
  step_dummy(all_nominal(), -all_outcomes())

pre_mod <- linear_reg() %>% 
  set_engine("lm")

pre_workflow <- workflow() %>%
  add_model(pre_mod) %>%
  add_recipe(pre_rec)

pre_fit <- pre_workflow %>%
  fit(data = pre_train_data)

pre_pred <- predict(pre_fit, pre_test_data) %>% 
  bind_cols(pre_test_data) 
pre_pred

```
---
# Code

```{r boring-regression}
# a boring regression
model <- lm(dist ~ speed, data = cars)
tidy(model)
glance(model)
```

---

# Plots

```{r recode-species, echo = FALSE}
# In this chunk I'm doing a bunch of analysis that I don't want to present 
# in my slides. But I need the resulting data frame for a plot I want to present.
iris_modified <- iris %>%
  mutate(Species = fct_other(Species, keep = "setosa"))
```

```{r plot-iris, echo = FALSE}
# Code hidden with echo = FALSE
# Uses modified iris dataset from previous chunk
# Play around with height and width until you're happy with the look
ggplot(data = iris_modified, mapping = aes(x = Sepal.Width, y = Sepal.Length, color = Species)) +
  geom_point() + 
  theme_minimal() # theme options: https://ggplot2.tidyverse.org/reference/ggtheme.html
```

---

## Plot and text

.pull-left[
- Some text
- goes here
]
.pull-right[
```{r warning=FALSE, out.width="100%", fig.width=4, echo=FALSE}
# see how I changed out.width and fig.width from defaults
# to make the figure bigger
ggplot(penguins, aes(x = bill_length_mm, y = species, color = species)) +
  geom_boxplot() +
  theme_minimal()
```
]

---

# Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r iris-table, echo = FALSE}
kable(head(iris), format = "html")
```

---

# Images

```{r castle, echo = FALSE, out.width = "55%", fig.align = "center", fig.cap = "Image credit: Photo by Jörg Angeli on Unsplash."}
include_graphics("img/edinburgh-castle.jpg")
```

Or you can also include a full page image. See next slide.

---


class: inverse, center, middle
background-image: url(img/edinburgh-castle.jpg)
background-size: contain
---

# Math Expressions

You can write LaTeX math expressions inside a pair of dollar signs, e.g. &#36;\alpha+\beta$ renders $\alpha+\beta$. You can use the display style with double dollar signs:

```
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$

Limitations:

1. The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

1. There should not be spaces after the opening `$` or before the closing `$`.

1. Math does not work on the title slide (see [#61](https://github.com/yihui/xaringan/issues/61) for a workaround).

---

# Feeling adventurous?

- Want to find out more about `xaringan`? See https://slides.yihui.name/xaringan/#1.

- You are welcome to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

- But some of you might want to play around with slide styling. The 
`xaringanthemer` provides some solutions for this that: https://pkg.garrickadenbuie.com/xaringanthemer.

- And if you want more bells and whistles, there is also `xaringanExtra`: https://pkg.garrickadenbuie.com/xaringanExtra.
